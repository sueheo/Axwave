<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì›í‹°ë“œ ì±„ìš©ê³µê³  ê²€ìƒ‰ (ì „ì²´+ë”ë³´ê¸° ë²„ì „)</title>
<style>
  body {
    font-family: "Pretendard", -apple-system, BlinkMacSystemFont, sans-serif;
    background: #f3f4f6;
    margin: 0;
    padding: 20px;
  }
  h1 {
    text-align: center;
    font-size: 28px;
    margin-bottom: 30px;
    color: #1e3a8a;
  }
  .filter-box {
    background: white;
    border-radius: 16px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    padding: 24px;
    margin-bottom: 28px;
  }
  .filter-section {
    margin-bottom: 16px;
  }
  .filter-title {
    font-weight: 600;
    color: #111827;
    margin-bottom: 8px;
  }
  .filter-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }
  .filter-group label {
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 6px 10px;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .filter-group input[type="checkbox"] {
    margin-right: 5px;
    accent-color: #2563eb;
  }
  .filter-group label:hover {
    background: #e0ecff;
    border-color: #93c5fd;
  }
  select, button {
    padding: 8px 12px;
    border-radius: 8px;
    border: 1px solid #d1d5db;
    font-size: 14px;
  }
  button {
    background: #2563eb;
    color: white;
    font-weight: 500;
    border: none;
    margin-top: 8px;
    transition: background 0.2s;
  }
  button:hover {
    background: #1e40af;
  }
  .cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
  }
  .card {
    background: white;
    border-radius: 14px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    overflow: hidden;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .card:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 14px rgba(0,0,0,0.15);
  }
  .card img {
    width: 100%;
    height: 160px;
    object-fit: cover;
  }
  .card-content {
    padding: 14px 16px;
  }
  .card-content h3 {
    font-size: 16px;
    margin: 4px 0;
    color: #1f2937;
  }
  .card-content p {
    margin: 3px 0;
    color: #6b7280;
    font-size: 14px;
  }
  a {
    text-decoration: none;
    color: inherit;
  }
  #loadMoreBtn {
    display: block;
    margin: 30px auto;
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    background: #2563eb;
    color: white;
    cursor: pointer;
    font-weight: 500;
    transition: 0.2s;
  }
  #loadMoreBtn:hover {
    background: #1e40af;
  }
</style>
</head>
<body>
  <h1>ğŸ’¼ ì›í‹°ë“œ ì±„ìš©ê³µê³  ê²€ìƒ‰</h1>

  <div class="filter-box">
    <div class="filter-section">
      <div class="filter-title">ğŸ“ ì§€ì—­ ì„ íƒ</div>
      <div class="filter-group" id="region-box">
        <label><input type="checkbox" value="ì„œìš¸">ì„œìš¸</label>
        <label><input type="checkbox" value="ê²½ê¸°">ê²½ê¸°</label>
        <label><input type="checkbox" value="ì¸ì²œ">ì¸ì²œ</label>
        <label><input type="checkbox" value="ë¶€ì‚°">ë¶€ì‚°</label>
        <label><input type="checkbox" value="ëŒ€ì „">ëŒ€ì „</label>
        <label><input type="checkbox" value="ëŒ€êµ¬">ëŒ€êµ¬</label>
        <label><input type="checkbox" value="ê´‘ì£¼">ê´‘ì£¼</label>
        <label><input type="checkbox" value="ìš¸ì‚°">ìš¸ì‚°</label>
        <label><input type="checkbox" value="ê°•ì›">ê°•ì›</label>
        <label><input type="checkbox" value="ì¶©ë¶">ì¶©ë¶</label>
        <label><input type="checkbox" value="ì¶©ë‚¨">ì¶©ë‚¨</label>
        <label><input type="checkbox" value="ì „ë¶">ì „ë¶</label>
        <label><input type="checkbox" value="ì „ë‚¨">ì „ë‚¨</label>
        <label><input type="checkbox" value="ê²½ë¶">ê²½ë¶</label>
        <label><input type="checkbox" value="ê²½ë‚¨">ê²½ë‚¨</label>
        <label><input type="checkbox" value="ì œì£¼">ì œì£¼</label>
      </div>
    </div>

    <div class="filter-section">
      <div class="filter-title">ğŸ§  ì§ë¬´ ì„ íƒ</div>
      <div class="filter-group" id="job-box">
        <label><input type="checkbox" value="ê°œë°œ">ê°œë°œ</label>
        <label><input type="checkbox" value="í”„ë¡ íŠ¸ì—”ë“œ">í”„ë¡ íŠ¸ì—”ë“œ</label>
        <label><input type="checkbox" value="ë°±ì—”ë“œ">ë°±ì—”ë“œ</label>
        <label><input type="checkbox" value="ë°ì´í„°">ë°ì´í„°</label>
        <label><input type="checkbox" value="AI">AI</label>
        <label><input type="checkbox" value="ë””ìì¸">ë””ìì¸</label>
        <label><input type="checkbox" value="ë§ˆì¼€íŒ…">ë§ˆì¼€íŒ…</label>
        <label><input type="checkbox" value="ì˜ì—…">ì˜ì—…</label>
        <label><input type="checkbox" value="ê¸°íš">ê¸°íš</label>
        <label><input type="checkbox" value="ìš´ì˜">ìš´ì˜</label>
        <label><input type="checkbox" value="PM">PM</label>
        <label><input type="checkbox" value="ì¸ì‚¬">ì¸ì‚¬</label>
      </div>
    </div>

    <div class="filter-section">
      <div class="filter-title">ğŸ“… ê²½ë ¥</div>
      <select id="years">
        <option value="">ì „ì²´</option>
        <option value="0">ì‹ ì…</option>
        <option value="1">1ë…„ ì´ìƒ</option>
        <option value="3">3ë…„ ì´ìƒ</option>
        <option value="5">5ë…„ ì´ìƒ</option>
        <option value="7">7ë…„ ì´ìƒ</option>
        <option value="10">10ë…„ ì´ìƒ</option>
      </select>
    </div>

    <button onclick="filterJobs()">ğŸ” ê²€ìƒ‰í•˜ê¸°</button>
  </div>

  <div id="results" class="cards"></div>

  <script>
    let allJobs = [];
    let filteredJobs = [];
    let currentIndex = 0;
    const PAGE_SIZE = 50;

    // ì „ì²´ í˜ì´ì§€ ë¶ˆëŸ¬ì˜¤ê¸° (offset ë°˜ë³µ)
    async function fetchAllJobs() {
      const proxy = "https://cors-anywhere.herokuapp.com/";
      const baseUrl = "https://www.wanted.co.kr/api/v4/jobs?country=kr&limit=100&job_sort=job.latest_order";
      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = "<p>ğŸ“¡ ì „ì²´ ì±„ìš©ê³µê³  ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>";

      let offset = 0;
      allJobs = [];

      try {
        while (true) {
          const url = proxy + `${baseUrl}&offset=${offset}`;
          const res = await fetch(url);
          if (!res.ok) break;
          const data = await res.json();
          const jobs = data.data || [];
          if (jobs.length === 0) break;

          allJobs.push(...jobs);
          resultsDiv.innerHTML = `<p>ğŸ“¦ ${allJobs.length}ê°œ ë¡œë“œ ì¤‘...</p>`;

          if (jobs.length < 100 || offset >= 2000) break;
          offset += 100;
          await new Promise(r => setTimeout(r, 500)); // ì„œë²„ ë¶€í•˜ ë°©ì§€
        }

        resultsDiv.innerHTML = `<p>âœ… ì´ ${allJobs.length}ê°œ ê³µê³  ë¡œë“œ ì™„ë£Œ!</p>`;
        renderJobs(allJobs.slice(0, PAGE_SIZE));
      } catch (e) {
        resultsDiv.innerHTML = `
          <p style="color:red;">âš ï¸ CORS ì ‘ê·¼ ì˜¤ë¥˜<br>
          ğŸ‘‰ <a href="https://cors-anywhere.herokuapp.com/corsdemo" target="_blank">ì—¬ê¸°</a> ì—ì„œ 'Request temporary access' í´ë¦­ í›„ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.</p>`;
      }
    }

    // í•„í„° ì ìš©
    function filterJobs() {
      if (allJobs.length === 0) {
        alert("ë¨¼ì € ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì•¼ í•©ë‹ˆë‹¤!");
        return;
      }

      const locations = Array.from(document.querySelectorAll("#region-box input:checked")).map(el => el.value);
      const jobs = Array.from(document.querySelectorAll("#job-box input:checked")).map(el => el.value);
      const years = document.getElementById("years").value;

      filteredJobs = allJobs;

      if (locations.length > 0) {
        filteredJobs = filteredJobs.filter(j => 
          locations.some(loc => (j.address?.full_location || "").includes(loc))
        );
      }
      if (jobs.length > 0) {
        filteredJobs = filteredJobs.filter(j => 
          jobs.some(k => (j.position || "").toLowerCase().includes(k.toLowerCase()))
        );
      }
      if (years) {
        filteredJobs = filteredJobs.filter(j => j.annual_from >= parseInt(years));
      }

      currentIndex = 0;
      renderJobs(filteredJobs);
    }

    // ì¹´ë“œ ë Œë”ë§
    function renderJobs(jobs, append = false) {
      const container = document.getElementById("results");
      if (!append) container.innerHTML = "";

      const nextJobs = jobs.slice(currentIndex, currentIndex + PAGE_SIZE);
      nextJobs.forEach(job => {
        const card = document.createElement("div");
        card.className = "card";

        const link = document.createElement("a");
        link.href = `https://www.wanted.co.kr/wd/${job.id}`;
        link.target = "_blank";

        const img = document.createElement("img");
        img.src = job.title_img?.thumb || job.logo_img?.thumb || "https://static.wanted.co.kr/images/wanted_default.png";

        const content = document.createElement("div");
        content.className = "card-content";

        const title = document.createElement("h3");
        title.textContent = job.position;

        const company = document.createElement("p");
        company.textContent = job.company?.name || "íšŒì‚¬ëª… ì—†ìŒ";

        const loc = document.createElement("p");
        loc.textContent = "ğŸ“ " + (job.address?.full_location || "ìœ„ì¹˜ ì •ë³´ ì—†ìŒ");

        content.append(title, company, loc);
        link.append(img, content);
        card.append(link);
        container.appendChild(card);
      });

      currentIndex += PAGE_SIZE;

      // ë”ë³´ê¸° ë²„íŠ¼ ì¶”ê°€
      const existingBtn = document.getElementById("loadMoreBtn");
      if (existingBtn) existingBtn.remove();

      if (currentIndex < jobs.length) {
        const btn = document.createElement("button");
        btn.id = "loadMoreBtn";
        btn.textContent = "ë”ë³´ê¸° (" + (jobs.length - currentIndex) + "ê°œ ë‚¨ìŒ)";
        btn.onclick = () => renderJobs(jobs, true);
        container.appendChild(btn);
      } else if (jobs.length > PAGE_SIZE) {
        const endMsg = document.createElement("p");
        endMsg.style.textAlign = "center";
        endMsg.textContent = "âœ… ëª¨ë“  ê³µê³ ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.";
        container.appendChild(endMsg);
      }
    }

    // ì‹œì‘ ì‹œ ì „ì²´ ë¡œë“œ
    fetchAllJobs();
  </script>
</body>
</html>
